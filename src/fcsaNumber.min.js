(function(){var e,t={}.hasOwnProperty;e=angular.module("fcsa-number",[]);e.directive("fcsaNumber",["fcsaNumberConfig",function(e){var n,r,i,s,o,u,a,f,l,c,h,p,d;i=e.defaultOptions;s=function(e){var n,r,s,o;r=angular.copy(i);if(e&&e.options!=null){o=e.$eval(e.options);for(n in o){if(!t.call(o,n))continue;s=o[n];r[n]=s}}return r};toStandard=function(e){if(!e){return e}var t=e.toString();var n=t.length;var r="";var i=s();var o=i.decimalSeparator;var u=i.thousandsSeparator;for(var a=0;a<n;a++){var f=t[a];if(f!=u){if(f==o){f="."}r+=f}}if(r.indexOf(i.decimalSeparator)==r.length-1){r=r.substring(0,r.length-1)}return r};f=function(e){var t=toStandard(e);return!isNaN(parseFloat(t))&&isFinite(t)};a=function(e){return e<44||e>57||e===47};r=[0,8,13];u=function(e){return r.indexOf(e)===-1};o=function(e){return e!=null&&e.toString().split(s().decimalSeparator).length>2};makeFormatWithMaxDecimals=function(e){var t,n;var r=s();if(e>0){t="^-?\\d{1,3}(\\"+r.thousandsSeparator+"?\\d{3})*"+"\\"+r.decimalSeparator+"?\\d{0,"+e+"}$"}else{t="^-?\\d{1,3}(\\"+r.thousandsSeparator+"?\\d{3})*$"}n=new RegExp(t);return function(e){var t=n.test(e);return t}};p=function(e){return function(t,n){return n<=e}};d=function(e){return function(t,n){return n>=e}};h=function(e){return function(t){if(!t){return false}var n=s();var r=t.toString();var i=0;var o=0;for(var u=0;u<r.length;u++){var a=r[u];if(a>="0"&&a<="9"){i++}else{if(a==n.thousandsSeparator){continue}else if(a==n.decimalSeparator){if(o++){return false}}else{return false}}}return i<=e}};l=function(e){var t;t=[];t.push(makeFormatWithMaxDecimals(e.maxDecimals?e.maxDecimals:0));if(e.max!=null){t.push(p(e.max))}if(e.min!=null){t.push(d(e.min))}if(e.maxDigits!=null){t.push(h(e.maxDigits))}return function(e){var n,r,i,s;if(!f(e)){return false}if(o(e)){return false}r=Number(toStandard(e));for(n=i=0,s=t.length;0<=s?i<s:i>s;n=0<=s?++i:--i){if(!t[n](e,r)){return false}}return true}};n=function(e){var t,n,r;var i=s();var o=i.decimalSeparator;var u=i.thousandsSeparator;var n="";var a=e.indexOf(o);if(a>=0&&a<e.length-1){n=e.substring(a)}r=e.replace(new RegExp("(\\"+o+"\\d*)$"),"");t=r.replace(new RegExp("(\\d)(?=(\\d{3})+(?!\\d))","g"),"$1"+u);var f=""+t+n;return f};return{restrict:"A",require:"ngModel",scope:{options:"@fcsaNumber"},link:function(e,t,r,i){var o,f;f=s(e);o=l(f);i.$parsers.unshift(function(e){if(!e||o(e)){i.$setValidity("fcsaNumber",true);return e}else{i.$setValidity("fcsaNumber",false);return void 0}});i.$formatters.push(function(e){if(f.nullDisplay!=null&&(!e||e==="")){return f.nullDisplay}if(e==null||!o(e)){return e}i.$setValidity("fcsaNumber",true);e=n(e.toString());if(f.prepend!=null){e=""+f.prepend+e}if(f.append!=null){e=""+e+f.append}return e});t.on("blur",function(){var e,t,n,r,s;t=i.$modelValue;if(t==null||!f.autoFormat||!o(t)){return}s=i.$formatters;for(n=0,r=s.length;n<r;n++){e=s[n];t=e(t)}i.$viewValue=t;return i.$render()});t.on("focus",function(){var e;e=t.val();if(f.prepend!=null){e=e.replace(f.prepend,"")}if(f.append!=null){e=e.replace(f.append,"")}if(!f.keepThousandsOnInput){if(e){e=Number(toStandard(e)).toString();e=e.replace(new RegExp("\\"+f.thousandsSeparator,"g"),f.decimalSeparator)}}t.val(e);return t[0].select()});if(f.preventInvalidInput===true){return t.on("keypress",function(e){if(a(e.which)&&u(e.which)){return e.preventDefault()}})}}}}]);e.provider("fcsaNumberConfig",function(){var e;whatDecimalSeparator=function(){var e=1.1;e=e.toLocaleString();var t=new RegExp("^1(.+)1\\d*$");e=e&&t.exec(e);e=e?e[1]:".";return e};whatThousandsSeparator=function(){var e=1111;e=e.toLocaleString();var t=new RegExp("^1(.+)111(\\"+whatDecimalSeparator()+"\\d*)?$");e=e&&t.exec(e);e=e?e[1]:",";return e};e={decimalSeparator:whatDecimalSeparator(),thousandsSeparator:whatThousandsSeparator()};this.setDefaultOptions=function(t){for(var n in t){e[n]=t[n]}return e};this.$get=function(){return{defaultOptions:e}}})}).call(this)